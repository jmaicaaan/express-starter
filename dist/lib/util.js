'use strict';

var _bcrypt = require('bcrypt');

var _bcrypt2 = _interopRequireDefault(_bcrypt);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var Util;

Util = function Util() {};

Util.prototype.getAccessToken = function (req) {
  return getAccessTokenFromHeaders(req);
};

Util.prototype.unauthorizedError = function (message) {
  var error = createError(message || 'User unauthorized', 'USER_UNAUTHORIZED');
  return error;
};

Util.prototype.invalidLoginError = function (message) {
  var error = createError(message || 'Invalid login credentials', 'INVALID_LOGIN_CREDENTIALS');
  return error;
};

Util.prototype.hashPassword = function (password) {
  var saltRounds = 10;
  return _bcrypt2.default.hash(password, saltRounds);
};

// helpers

function createError(message, name) {
  var error = new Error(message);
  error.name = name;
  return error;
}

function getAccessTokenFromHeaders(req) {
  var headers = req.headers;
  var accessToken = headers['authorization'];
  return accessToken;
}

module.exports.Util = Util;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL2FwcC9saWIvdXRpbC5qcyJdLCJuYW1lcyI6WyJVdGlsIiwicHJvdG90eXBlIiwiZ2V0QWNjZXNzVG9rZW4iLCJyZXEiLCJnZXRBY2Nlc3NUb2tlbkZyb21IZWFkZXJzIiwidW5hdXRob3JpemVkRXJyb3IiLCJtZXNzYWdlIiwiZXJyb3IiLCJjcmVhdGVFcnJvciIsImludmFsaWRMb2dpbkVycm9yIiwiaGFzaFBhc3N3b3JkIiwicGFzc3dvcmQiLCJzYWx0Um91bmRzIiwiaGFzaCIsIm5hbWUiLCJFcnJvciIsImhlYWRlcnMiLCJhY2Nlc3NUb2tlbiIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7O0FBQUE7Ozs7OztBQUVBLElBQUlBLElBQUo7O0FBRUFBLE9BQU8sZ0JBQVcsQ0FBRSxDQUFwQjs7QUFFQUEsS0FBS0MsU0FBTCxDQUFlQyxjQUFmLEdBQWdDLFVBQVNDLEdBQVQsRUFBYztBQUM1QyxTQUFPQywwQkFBMEJELEdBQTFCLENBQVA7QUFDRCxDQUZEOztBQUlBSCxLQUFLQyxTQUFMLENBQWVJLGlCQUFmLEdBQW1DLFVBQVNDLE9BQVQsRUFBa0I7QUFDbkQsTUFBTUMsUUFBUUMsWUFBWUYsV0FBVyxtQkFBdkIsRUFBNEMsbUJBQTVDLENBQWQ7QUFDQSxTQUFPQyxLQUFQO0FBQ0QsQ0FIRDs7QUFLQVAsS0FBS0MsU0FBTCxDQUFlUSxpQkFBZixHQUFtQyxVQUFTSCxPQUFULEVBQWtCO0FBQ25ELE1BQU1DLFFBQVFDLFlBQVlGLFdBQVcsMkJBQXZCLEVBQW9ELDJCQUFwRCxDQUFkO0FBQ0EsU0FBT0MsS0FBUDtBQUNELENBSEQ7O0FBS0FQLEtBQUtDLFNBQUwsQ0FBZVMsWUFBZixHQUE4QixVQUFTQyxRQUFULEVBQW1CO0FBQy9DLE1BQU1DLGFBQWEsRUFBbkI7QUFDQSxTQUFPLGlCQUFPQyxJQUFQLENBQVlGLFFBQVosRUFBc0JDLFVBQXRCLENBQVA7QUFDRCxDQUhEOztBQUtBOztBQUVBLFNBQVNKLFdBQVQsQ0FBcUJGLE9BQXJCLEVBQThCUSxJQUE5QixFQUFvQztBQUNsQyxNQUFNUCxRQUFRLElBQUlRLEtBQUosQ0FBVVQsT0FBVixDQUFkO0FBQ0FDLFFBQU1PLElBQU4sR0FBYUEsSUFBYjtBQUNBLFNBQU9QLEtBQVA7QUFDRDs7QUFFRCxTQUFTSCx5QkFBVCxDQUFtQ0QsR0FBbkMsRUFBd0M7QUFDdEMsTUFBTWEsVUFBVWIsSUFBSWEsT0FBcEI7QUFDQSxNQUFNQyxjQUFjRCxRQUFRLGVBQVIsQ0FBcEI7QUFDQSxTQUFPQyxXQUFQO0FBQ0Q7O0FBRURDLE9BQU9DLE9BQVAsQ0FBZW5CLElBQWYsR0FBc0JBLElBQXRCIiwiZmlsZSI6InV0aWwuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgYmNyeXB0IGZyb20gJ2JjcnlwdCc7XHJcblxyXG52YXIgVXRpbDtcclxuXHJcblV0aWwgPSBmdW5jdGlvbigpIHt9O1xyXG5cclxuVXRpbC5wcm90b3R5cGUuZ2V0QWNjZXNzVG9rZW4gPSBmdW5jdGlvbihyZXEpIHtcclxuICByZXR1cm4gZ2V0QWNjZXNzVG9rZW5Gcm9tSGVhZGVycyhyZXEpO1xyXG59XHJcblxyXG5VdGlsLnByb3RvdHlwZS51bmF1dGhvcml6ZWRFcnJvciA9IGZ1bmN0aW9uKG1lc3NhZ2UpIHtcclxuICBjb25zdCBlcnJvciA9IGNyZWF0ZUVycm9yKG1lc3NhZ2UgfHwgJ1VzZXIgdW5hdXRob3JpemVkJywgJ1VTRVJfVU5BVVRIT1JJWkVEJyk7XHJcbiAgcmV0dXJuIGVycm9yO1xyXG59XHJcblxyXG5VdGlsLnByb3RvdHlwZS5pbnZhbGlkTG9naW5FcnJvciA9IGZ1bmN0aW9uKG1lc3NhZ2UpIHtcclxuICBjb25zdCBlcnJvciA9IGNyZWF0ZUVycm9yKG1lc3NhZ2UgfHwgJ0ludmFsaWQgbG9naW4gY3JlZGVudGlhbHMnLCAnSU5WQUxJRF9MT0dJTl9DUkVERU5USUFMUycpO1xyXG4gIHJldHVybiBlcnJvcjtcclxufVxyXG5cclxuVXRpbC5wcm90b3R5cGUuaGFzaFBhc3N3b3JkID0gZnVuY3Rpb24ocGFzc3dvcmQpIHtcclxuICBjb25zdCBzYWx0Um91bmRzID0gMTA7XHJcbiAgcmV0dXJuIGJjcnlwdC5oYXNoKHBhc3N3b3JkLCBzYWx0Um91bmRzKTtcclxufVxyXG5cclxuLy8gaGVscGVyc1xyXG5cclxuZnVuY3Rpb24gY3JlYXRlRXJyb3IobWVzc2FnZSwgbmFtZSkge1xyXG4gIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKG1lc3NhZ2UpO1xyXG4gIGVycm9yLm5hbWUgPSBuYW1lO1xyXG4gIHJldHVybiBlcnJvcjtcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0QWNjZXNzVG9rZW5Gcm9tSGVhZGVycyhyZXEpIHtcclxuICBjb25zdCBoZWFkZXJzID0gcmVxLmhlYWRlcnM7XHJcbiAgY29uc3QgYWNjZXNzVG9rZW4gPSBoZWFkZXJzWydhdXRob3JpemF0aW9uJ107XHJcbiAgcmV0dXJuIGFjY2Vzc1Rva2VuO1xyXG59XHJcblxyXG5tb2R1bGUuZXhwb3J0cy5VdGlsID0gVXRpbDsiXX0=