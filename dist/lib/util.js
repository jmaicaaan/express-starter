'use strict';

var Util;

Util = function Util() {};

Util.prototype.getAccessToken = function (req) {
  return getAccessTokenFromHeaders(req);
};

Util.prototype.unauthorizedError = function (message) {
  var error = createError(message || 'User unauthorized', 'USER_UNAUTHORIZED');
  return error;
};

Util.prototype.invalidLoginError = function (message) {
  var error = createError(message || 'Invalid login credentials', 'INVALID_LOGIN_CREDENTIALS');
  return error;
};

// helpers

function createError(message, name) {
  var error = new Error(message);
  error.name = name;
  return error;
}

function getAccessTokenFromHeaders(req) {
  var headers = req.headers;
  var accessToken = headers['authorization'];
  return accessToken;
}

module.exports.Util = Util;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL2FwcC9saWIvdXRpbC5qcyJdLCJuYW1lcyI6WyJVdGlsIiwicHJvdG90eXBlIiwiZ2V0QWNjZXNzVG9rZW4iLCJyZXEiLCJnZXRBY2Nlc3NUb2tlbkZyb21IZWFkZXJzIiwidW5hdXRob3JpemVkRXJyb3IiLCJtZXNzYWdlIiwiZXJyb3IiLCJjcmVhdGVFcnJvciIsImludmFsaWRMb2dpbkVycm9yIiwibmFtZSIsIkVycm9yIiwiaGVhZGVycyIsImFjY2Vzc1Rva2VuIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxJQUFJQSxJQUFKOztBQUVBQSxPQUFPLGdCQUFXLENBQUUsQ0FBcEI7O0FBRUFBLEtBQUtDLFNBQUwsQ0FBZUMsY0FBZixHQUFnQyxVQUFTQyxHQUFULEVBQWM7QUFDNUMsU0FBT0MsMEJBQTBCRCxHQUExQixDQUFQO0FBQ0QsQ0FGRDs7QUFJQUgsS0FBS0MsU0FBTCxDQUFlSSxpQkFBZixHQUFtQyxVQUFTQyxPQUFULEVBQWtCO0FBQ25ELE1BQU1DLFFBQVFDLFlBQVlGLFdBQVcsbUJBQXZCLEVBQTRDLG1CQUE1QyxDQUFkO0FBQ0EsU0FBT0MsS0FBUDtBQUNELENBSEQ7O0FBS0FQLEtBQUtDLFNBQUwsQ0FBZVEsaUJBQWYsR0FBbUMsVUFBU0gsT0FBVCxFQUFrQjtBQUNuRCxNQUFNQyxRQUFRQyxZQUFZRixXQUFXLDJCQUF2QixFQUFvRCwyQkFBcEQsQ0FBZDtBQUNBLFNBQU9DLEtBQVA7QUFDRCxDQUhEOztBQUtBOztBQUVBLFNBQVNDLFdBQVQsQ0FBcUJGLE9BQXJCLEVBQThCSSxJQUE5QixFQUFvQztBQUNsQyxNQUFNSCxRQUFRLElBQUlJLEtBQUosQ0FBVUwsT0FBVixDQUFkO0FBQ0FDLFFBQU1HLElBQU4sR0FBYUEsSUFBYjtBQUNBLFNBQU9ILEtBQVA7QUFDRDs7QUFFRCxTQUFTSCx5QkFBVCxDQUFtQ0QsR0FBbkMsRUFBd0M7QUFDdEMsTUFBTVMsVUFBVVQsSUFBSVMsT0FBcEI7QUFDQSxNQUFNQyxjQUFjRCxRQUFRLGVBQVIsQ0FBcEI7QUFDQSxTQUFPQyxXQUFQO0FBQ0Q7O0FBRURDLE9BQU9DLE9BQVAsQ0FBZWYsSUFBZixHQUFzQkEsSUFBdEIiLCJmaWxlIjoidXRpbC5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBVdGlsO1xyXG5cclxuVXRpbCA9IGZ1bmN0aW9uKCkge307XHJcblxyXG5VdGlsLnByb3RvdHlwZS5nZXRBY2Nlc3NUb2tlbiA9IGZ1bmN0aW9uKHJlcSkge1xyXG4gIHJldHVybiBnZXRBY2Nlc3NUb2tlbkZyb21IZWFkZXJzKHJlcSk7XHJcbn1cclxuXHJcblV0aWwucHJvdG90eXBlLnVuYXV0aG9yaXplZEVycm9yID0gZnVuY3Rpb24obWVzc2FnZSkge1xyXG4gIGNvbnN0IGVycm9yID0gY3JlYXRlRXJyb3IobWVzc2FnZSB8fCAnVXNlciB1bmF1dGhvcml6ZWQnLCAnVVNFUl9VTkFVVEhPUklaRUQnKTtcclxuICByZXR1cm4gZXJyb3I7XHJcbn1cclxuXHJcblV0aWwucHJvdG90eXBlLmludmFsaWRMb2dpbkVycm9yID0gZnVuY3Rpb24obWVzc2FnZSkge1xyXG4gIGNvbnN0IGVycm9yID0gY3JlYXRlRXJyb3IobWVzc2FnZSB8fCAnSW52YWxpZCBsb2dpbiBjcmVkZW50aWFscycsICdJTlZBTElEX0xPR0lOX0NSRURFTlRJQUxTJyk7XHJcbiAgcmV0dXJuIGVycm9yO1xyXG59XHJcblxyXG4vLyBoZWxwZXJzXHJcblxyXG5mdW5jdGlvbiBjcmVhdGVFcnJvcihtZXNzYWdlLCBuYW1lKSB7XHJcbiAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IobWVzc2FnZSk7XHJcbiAgZXJyb3IubmFtZSA9IG5hbWU7XHJcbiAgcmV0dXJuIGVycm9yO1xyXG59XHJcblxyXG5mdW5jdGlvbiBnZXRBY2Nlc3NUb2tlbkZyb21IZWFkZXJzKHJlcSkge1xyXG4gIGNvbnN0IGhlYWRlcnMgPSByZXEuaGVhZGVycztcclxuICBjb25zdCBhY2Nlc3NUb2tlbiA9IGhlYWRlcnNbJ2F1dGhvcml6YXRpb24nXTtcclxuICByZXR1cm4gYWNjZXNzVG9rZW47XHJcbn1cclxuXHJcbm1vZHVsZS5leHBvcnRzLlV0aWwgPSBVdGlsOyJdfQ==