'use strict';

var Util;

Util = function Util() {};

Util.prototype.getAccessToken = function (req) {
  return getAccessTokenFromHeaders(req);
};

Util.prototype.unauthorizedError = function (res, message) {
  var error = createError(message || 'User unauthorized');
  res.status(401);
  return error;
};

// helpers

function createError(message) {
  var error = new Error(message);
  return error;
}

function getAccessTokenFromHeaders(req) {
  var headers = req.headers;
  var accessToken = headers['authorization'];
  return accessToken;
}

module.exports.Util = Util;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL2FwcC9saWIvdXRpbC5qcyJdLCJuYW1lcyI6WyJVdGlsIiwicHJvdG90eXBlIiwiZ2V0QWNjZXNzVG9rZW4iLCJyZXEiLCJnZXRBY2Nlc3NUb2tlbkZyb21IZWFkZXJzIiwidW5hdXRob3JpemVkRXJyb3IiLCJyZXMiLCJtZXNzYWdlIiwiZXJyb3IiLCJjcmVhdGVFcnJvciIsInN0YXR1cyIsIkVycm9yIiwiaGVhZGVycyIsImFjY2Vzc1Rva2VuIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxJQUFJQSxJQUFKOztBQUVBQSxPQUFPLGdCQUFXLENBQUUsQ0FBcEI7O0FBRUFBLEtBQUtDLFNBQUwsQ0FBZUMsY0FBZixHQUFnQyxVQUFTQyxHQUFULEVBQWM7QUFDNUMsU0FBT0MsMEJBQTBCRCxHQUExQixDQUFQO0FBQ0QsQ0FGRDs7QUFJQUgsS0FBS0MsU0FBTCxDQUFlSSxpQkFBZixHQUFtQyxVQUFTQyxHQUFULEVBQWNDLE9BQWQsRUFBdUI7QUFDeEQsTUFBTUMsUUFBUUMsWUFBWUYsV0FBVyxtQkFBdkIsQ0FBZDtBQUNBRCxNQUFJSSxNQUFKLENBQVcsR0FBWDtBQUNBLFNBQU9GLEtBQVA7QUFDRCxDQUpEOztBQU1BOztBQUVBLFNBQVNDLFdBQVQsQ0FBcUJGLE9BQXJCLEVBQThCO0FBQzVCLE1BQU1DLFFBQVEsSUFBSUcsS0FBSixDQUFVSixPQUFWLENBQWQ7QUFDQSxTQUFPQyxLQUFQO0FBQ0Q7O0FBRUQsU0FBU0oseUJBQVQsQ0FBbUNELEdBQW5DLEVBQXdDO0FBQ3RDLE1BQU1TLFVBQVVULElBQUlTLE9BQXBCO0FBQ0EsTUFBTUMsY0FBY0QsUUFBUSxlQUFSLENBQXBCO0FBQ0EsU0FBT0MsV0FBUDtBQUNEOztBQUVEQyxPQUFPQyxPQUFQLENBQWVmLElBQWYsR0FBc0JBLElBQXRCIiwiZmlsZSI6InV0aWwuanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgVXRpbDtcclxuXHJcblV0aWwgPSBmdW5jdGlvbigpIHt9O1xyXG5cclxuVXRpbC5wcm90b3R5cGUuZ2V0QWNjZXNzVG9rZW4gPSBmdW5jdGlvbihyZXEpIHtcclxuICByZXR1cm4gZ2V0QWNjZXNzVG9rZW5Gcm9tSGVhZGVycyhyZXEpO1xyXG59XHJcblxyXG5VdGlsLnByb3RvdHlwZS51bmF1dGhvcml6ZWRFcnJvciA9IGZ1bmN0aW9uKHJlcywgbWVzc2FnZSkge1xyXG4gIGNvbnN0IGVycm9yID0gY3JlYXRlRXJyb3IobWVzc2FnZSB8fCAnVXNlciB1bmF1dGhvcml6ZWQnKTtcclxuICByZXMuc3RhdHVzKDQwMSk7XHJcbiAgcmV0dXJuIGVycm9yO1xyXG59XHJcblxyXG4vLyBoZWxwZXJzXHJcblxyXG5mdW5jdGlvbiBjcmVhdGVFcnJvcihtZXNzYWdlKSB7XHJcbiAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IobWVzc2FnZSk7XHJcbiAgcmV0dXJuIGVycm9yO1xyXG59XHJcblxyXG5mdW5jdGlvbiBnZXRBY2Nlc3NUb2tlbkZyb21IZWFkZXJzKHJlcSkge1xyXG4gIGNvbnN0IGhlYWRlcnMgPSByZXEuaGVhZGVycztcclxuICBjb25zdCBhY2Nlc3NUb2tlbiA9IGhlYWRlcnNbJ2F1dGhvcml6YXRpb24nXTtcclxuICByZXR1cm4gYWNjZXNzVG9rZW47XHJcbn1cclxuXHJcbm1vZHVsZS5leHBvcnRzLlV0aWwgPSBVdGlsOyJdfQ==