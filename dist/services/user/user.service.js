'use strict';

var _models = require('../../../models');

var _models2 = _interopRequireDefault(_models);

var _index = require('../index');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var UserService;

UserService = function UserService() {
  this.accessTokenService = new _index.AccessTokenService();
};

UserService.prototype.addUser = function (username, password) {
  return _models2.default.User.create({ username: username, password: password });
};

UserService.prototype.login = function (username, password) {
  var _this = this;

  return _models2.default.User.findOne({ where: { username: username, password: password } }).then(function (user) {
    return _this.accessTokenService.addUserToken(user.id).then(function (accessToken) {
      user.get().accessToken = accessToken.get();
      return user;
    });
  }).then(function (user) {
    return user;
  });
};

UserService.prototype.find = function () {
  return _models2.default.User.find({ include: [_models2.default.accessToken] });
};

module.exports.UserService = UserService;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL2FwcC9zZXJ2aWNlcy91c2VyL3VzZXIuc2VydmljZS5qcyJdLCJuYW1lcyI6WyJVc2VyU2VydmljZSIsImFjY2Vzc1Rva2VuU2VydmljZSIsInByb3RvdHlwZSIsImFkZFVzZXIiLCJ1c2VybmFtZSIsInBhc3N3b3JkIiwiVXNlciIsImNyZWF0ZSIsImxvZ2luIiwiZmluZE9uZSIsIndoZXJlIiwidGhlbiIsInVzZXIiLCJhZGRVc2VyVG9rZW4iLCJpZCIsImFjY2Vzc1Rva2VuIiwiZ2V0IiwiZmluZCIsImluY2x1ZGUiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBOzs7O0FBQ0E7Ozs7QUFFQSxJQUFJQSxXQUFKOztBQUVBQSxjQUFjLHVCQUFXO0FBQ3ZCLE9BQUtDLGtCQUFMLEdBQTBCLCtCQUExQjtBQUNELENBRkQ7O0FBSUFELFlBQVlFLFNBQVosQ0FBc0JDLE9BQXRCLEdBQWdDLFVBQVNDLFFBQVQsRUFBbUJDLFFBQW5CLEVBQTZCO0FBQzNELFNBQU8saUJBQU9DLElBQVAsQ0FBWUMsTUFBWixDQUFtQixFQUFFSCxrQkFBRixFQUFZQyxrQkFBWixFQUFuQixDQUFQO0FBQ0QsQ0FGRDs7QUFJQUwsWUFBWUUsU0FBWixDQUFzQk0sS0FBdEIsR0FBOEIsVUFBU0osUUFBVCxFQUFtQkMsUUFBbkIsRUFBNkI7QUFBQTs7QUFDekQsU0FBTyxpQkFBT0MsSUFBUCxDQUFZRyxPQUFaLENBQW9CLEVBQUVDLE9BQU8sRUFBRU4sa0JBQUYsRUFBWUMsa0JBQVosRUFBVCxFQUFwQixFQUNKTSxJQURJLENBQ0MsVUFBQ0MsSUFBRCxFQUFVO0FBQ2QsV0FBTyxNQUFLWCxrQkFBTCxDQUF3QlksWUFBeEIsQ0FBcUNELEtBQUtFLEVBQTFDLEVBQ0pILElBREksQ0FDQyxVQUFDSSxXQUFELEVBQWlCO0FBQ3JCSCxXQUFLSSxHQUFMLEdBQVdELFdBQVgsR0FBeUJBLFlBQVlDLEdBQVosRUFBekI7QUFDQSxhQUFPSixJQUFQO0FBQ0QsS0FKSSxDQUFQO0FBS0QsR0FQSSxFQVFKRCxJQVJJLENBUUMsVUFBQ0MsSUFBRDtBQUFBLFdBQVVBLElBQVY7QUFBQSxHQVJELENBQVA7QUFTRCxDQVZEOztBQVlBWixZQUFZRSxTQUFaLENBQXNCZSxJQUF0QixHQUE2QixZQUFXO0FBQ3RDLFNBQU8saUJBQU9YLElBQVAsQ0FBWVcsSUFBWixDQUFpQixFQUFFQyxTQUFTLENBQUUsaUJBQU9ILFdBQVQsQ0FBWCxFQUFqQixDQUFQO0FBQ0QsQ0FGRDs7QUFJQUksT0FBT0MsT0FBUCxDQUFlcEIsV0FBZixHQUE2QkEsV0FBN0IiLCJmaWxlIjoidXNlci5zZXJ2aWNlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG1vZGVscyBmcm9tICcuLi8uLi8uLi9tb2RlbHMnO1xyXG5pbXBvcnQgeyBBY2Nlc3NUb2tlblNlcnZpY2UgfSBmcm9tICcuLi9pbmRleCc7XHJcblxyXG52YXIgVXNlclNlcnZpY2U7XHJcblxyXG5Vc2VyU2VydmljZSA9IGZ1bmN0aW9uKCkge1xyXG4gIHRoaXMuYWNjZXNzVG9rZW5TZXJ2aWNlID0gbmV3IEFjY2Vzc1Rva2VuU2VydmljZSgpO1xyXG59O1xyXG5cclxuVXNlclNlcnZpY2UucHJvdG90eXBlLmFkZFVzZXIgPSBmdW5jdGlvbih1c2VybmFtZSwgcGFzc3dvcmQpIHtcclxuICByZXR1cm4gbW9kZWxzLlVzZXIuY3JlYXRlKHsgdXNlcm5hbWUsIHBhc3N3b3JkIH0pO1xyXG59O1xyXG5cclxuVXNlclNlcnZpY2UucHJvdG90eXBlLmxvZ2luID0gZnVuY3Rpb24odXNlcm5hbWUsIHBhc3N3b3JkKSB7XHJcbiAgcmV0dXJuIG1vZGVscy5Vc2VyLmZpbmRPbmUoeyB3aGVyZTogeyB1c2VybmFtZSwgcGFzc3dvcmQgfX0pXHJcbiAgICAudGhlbigodXNlcikgPT4ge1xyXG4gICAgICByZXR1cm4gdGhpcy5hY2Nlc3NUb2tlblNlcnZpY2UuYWRkVXNlclRva2VuKHVzZXIuaWQpXHJcbiAgICAgICAgLnRoZW4oKGFjY2Vzc1Rva2VuKSA9PiB7XHJcbiAgICAgICAgICB1c2VyLmdldCgpLmFjY2Vzc1Rva2VuID0gYWNjZXNzVG9rZW4uZ2V0KCk7XHJcbiAgICAgICAgICByZXR1cm4gdXNlcjtcclxuICAgICAgICB9KTtcclxuICAgIH0pXHJcbiAgICAudGhlbigodXNlcikgPT4gdXNlcik7XHJcbn07XHJcblxyXG5Vc2VyU2VydmljZS5wcm90b3R5cGUuZmluZCA9IGZ1bmN0aW9uKCkge1xyXG4gIHJldHVybiBtb2RlbHMuVXNlci5maW5kKHsgaW5jbHVkZTogWyBtb2RlbHMuYWNjZXNzVG9rZW4gXSB9KTtcclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzLlVzZXJTZXJ2aWNlID0gVXNlclNlcnZpY2U7Il19