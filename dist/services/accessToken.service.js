'use strict';

var _models = require('../../models');

var _models2 = _interopRequireDefault(_models);

var _crypto = require('crypto');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var AccessTokenService;

AccessTokenService = function AccessTokenService() {};

AccessTokenService.prototype.addUserToken = function (userId) {
  var buf = (0, _crypto.randomBytes)(15);
  var token = buf.toString('hex');
  return _models2.default.accessToken.create({ UserId: userId, token: token });
};

AccessTokenService.prototype.getUserByAccessToken = function (accessToken) {
  return _models2.default.accessToken.find({ where: { token: accessToken } });
};

module.exports.AccessTokenService = AccessTokenService;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL2FwcC9zZXJ2aWNlcy9hY2Nlc3NUb2tlbi5zZXJ2aWNlLmpzIl0sIm5hbWVzIjpbIkFjY2Vzc1Rva2VuU2VydmljZSIsInByb3RvdHlwZSIsImFkZFVzZXJUb2tlbiIsInVzZXJJZCIsImJ1ZiIsInRva2VuIiwidG9TdHJpbmciLCJhY2Nlc3NUb2tlbiIsImNyZWF0ZSIsIlVzZXJJZCIsImdldFVzZXJCeUFjY2Vzc1Rva2VuIiwiZmluZCIsIndoZXJlIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7QUFBQTs7OztBQUNBOzs7O0FBRUEsSUFBSUEsa0JBQUo7O0FBRUFBLHFCQUFxQiw4QkFBVyxDQUFFLENBQWxDOztBQUVBQSxtQkFBbUJDLFNBQW5CLENBQTZCQyxZQUE3QixHQUE0QyxVQUFTQyxNQUFULEVBQWlCO0FBQzNELE1BQU1DLE1BQU0seUJBQVksRUFBWixDQUFaO0FBQ0EsTUFBTUMsUUFBUUQsSUFBSUUsUUFBSixDQUFhLEtBQWIsQ0FBZDtBQUNBLFNBQU8saUJBQU9DLFdBQVAsQ0FBbUJDLE1BQW5CLENBQTBCLEVBQUVDLFFBQVFOLE1BQVYsRUFBa0JFLFlBQWxCLEVBQTFCLENBQVA7QUFDRCxDQUpEOztBQU1BTCxtQkFBbUJDLFNBQW5CLENBQTZCUyxvQkFBN0IsR0FBb0QsVUFBU0gsV0FBVCxFQUFzQjtBQUN4RSxTQUFPLGlCQUFPQSxXQUFQLENBQW1CSSxJQUFuQixDQUF3QixFQUFFQyxPQUFPLEVBQUVQLE9BQU9FLFdBQVQsRUFBVCxFQUF4QixDQUFQO0FBQ0QsQ0FGRDs7QUFJQU0sT0FBT0MsT0FBUCxDQUFlZCxrQkFBZixHQUFvQ0Esa0JBQXBDIiwiZmlsZSI6ImFjY2Vzc1Rva2VuLnNlcnZpY2UuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbW9kZWxzIGZyb20gJy4uLy4uL21vZGVscyc7XHJcbmltcG9ydCB7IHJhbmRvbUJ5dGVzIH0gZnJvbSAnY3J5cHRvJztcclxuXHJcbnZhciBBY2Nlc3NUb2tlblNlcnZpY2U7XHJcblxyXG5BY2Nlc3NUb2tlblNlcnZpY2UgPSBmdW5jdGlvbigpIHt9O1xyXG5cclxuQWNjZXNzVG9rZW5TZXJ2aWNlLnByb3RvdHlwZS5hZGRVc2VyVG9rZW4gPSBmdW5jdGlvbih1c2VySWQpIHtcclxuICBjb25zdCBidWYgPSByYW5kb21CeXRlcygxNSk7XHJcbiAgY29uc3QgdG9rZW4gPSBidWYudG9TdHJpbmcoJ2hleCcpO1xyXG4gIHJldHVybiBtb2RlbHMuYWNjZXNzVG9rZW4uY3JlYXRlKHsgVXNlcklkOiB1c2VySWQsIHRva2VuIH0pO1xyXG59O1xyXG5cclxuQWNjZXNzVG9rZW5TZXJ2aWNlLnByb3RvdHlwZS5nZXRVc2VyQnlBY2Nlc3NUb2tlbiA9IGZ1bmN0aW9uKGFjY2Vzc1Rva2VuKSB7XHJcbiAgcmV0dXJuIG1vZGVscy5hY2Nlc3NUb2tlbi5maW5kKHsgd2hlcmU6IHsgdG9rZW46IGFjY2Vzc1Rva2VuIH0gfSk7XHJcbn1cclxuXHJcbm1vZHVsZS5leHBvcnRzLkFjY2Vzc1Rva2VuU2VydmljZSA9IEFjY2Vzc1Rva2VuU2VydmljZTsiXX0=